/* conf.js, (c) 2016 mawentao */

define("ajax",["require"],function(e){var i={},t={},a="";return t.getAjaxUrl=function(e){return dz.mobileapi+"?"+e},t.getFormHash=function(){return a},t.ajaxrequest=function(e,i,t,o,n){jQuery.ajax({url:i,type:e,dataType:"json",data:t,async:n?!1:!0,complete:function(e){},success:function(e){e.Variables&&e.Variables.formhash&&(a=e.Variables.formhash),o(e)},error:function(e,i,t){var a="Error("+e.readyState+") : "+i;console.log(a),MWT.alert("啊哦~~页面发生了错误，刷新下看看~~")}})},t.post3=function(e,i,t,a){jQuery.ajax({url:e,type:"post",dataType:"xml",data:i,async:a?!1:!0,complete:function(e){},success:function(e){t(e)},error:function(e,i,t){var a="Error("+e.readyState+") : "+i;console.log(a),MWT.alert("啊哦~~页面发生了错误，刷新下看看~~")}})},t.post2=function(e,i,a,o){bigstyle_api||MWT.alert("请安装BigStyle模板配套插件");var n=bigstyle_api+e;t.ajaxrequest("post",n,i,a,o)},t.post=function(e,i,a,o){var n=t.getAjaxUrl(e);t.ajaxrequest("post",n,i,a,o)},t.get=function(e,i,a,o,n){var r=t.getAjaxUrl(i);t.ajaxrequest("get",r,a,o,n)},t.loadcache=function(e,t,a){i[e]?t(i[e]):this.post(e,{},function(a){i[e]=a,t(a)},a)},t.unsetcache=function(e){i[e]=null},t.clearcache=function(){i={}},t}),define("conf",["require","ajax"],function(e){var i,t=e("ajax"),a={loglevel:3,version:"1.5.0",default_forum_icon:dz.siteurl+"/template/bigstyle/touch/static/imgs/default_forum.png",copyright:"Comsenz Inc.",hotforums:{source:1,forums:[]},banners:[{image:dz.siteurl+"/template/bigstyle/touch/static/imgs/banner01.jpg",href:dz.siteurl},{image:dz.siteurl+"/template/bigstyle/touch/static/imgs/banner02.jpg",href:dz.siteurl},{image:dz.siteurl+"/template/bigstyle/touch/static/imgs/banner03.jpg",href:dz.siteurl}],uclist:[{icon:"icon icon-log",iconcolor:"#029C01",title:"我的资料",href:"home.php?mod=space&do=profile&mobile=2"},"-",{icon:"icon icon-topic",iconcolor:"#D9534F",title:"我的帖子",href:"home.php?mod=space&do=thread&mobile=2"},{icon:"icon icon-favor",iconcolor:"#E85E0D",title:"我的收藏",href:"home.php?mod=space&do=favorite&mobile=2"},"-",{icon:"icon icon-setting",iconcolor:"#086EA2",title:"设置",href:"forum.php?setting=1"}],adapi:"http://139.196.29.35:8888/api/bigstyle/getad"},o={};return o.get=function(){return bigstyle_api?(i||t.post2("config",{},function(e){e.data&&(i=e.data,a.banners=i.banners,a.default_forum_icon=i.default_forum_icon,i.uclist&&(a.uclist=i.uclist),i.copyright&&(a.copyright=i.copyright),i.hotforums&&(a.hotforums=i.hotforums),a.adapi="",i.adapi&&(a.adapi=i.adapi))},!0),a):a},o}),define("common/location",["require"],function(e){var i={};return i.back=function(e){window.history.length>1?window.history.back():e&&(window.location=e)},i.forumdisplay=function(e){window.location="forum.php?mod=forumdisplay&fid="+e},i.viewthread=function(e){window.location="forum.php?mod=viewthread&tid="+e},i}),define("data/forum",["require","ajax"],function(e){function i(){d.loadcache("version=4&module=forumindex",function(e){o={};for(var i=0;i<e.Variables.forumlist.length;++i){var a=e.Variables.forumlist[i];if(o[a.fid]={fid:a.fid,name:a.name,threads:a.threads,posts:a.posts,todayposts:a.todayposts,icon:a.icon?a.icon:bigstyle_conf.default_forum_icon},a.sublist&&a.sublist.length>0){o[a.fid].sublist=[];for(var n=0;n<a.sublist.length;++n){var r=a.sublist[n];o[a.fid].sublist.push(r.fid),o[r.fid]={fid:r.fid,name:r.name,threads:r.threads,posts:r.posts,todayposts:r.todayposts,icon:r.icon?r.icon:bigstyle_conf.default_forum_icon}}}}t(e)},!0)}function t(e){if(n='<option value="0">请选择版块</option>',e&&e.Variables.catlist)for(var i=0;i<e.Variables.catlist.length;++i){var t=e.Variables.catlist[i];if(t.forums&&t.forums.length){n+='<optgroup label="'+t.name+'">';for(var a=0;a<t.forums.length;++a){var r=t.forums[a],d=o[r];if(d&&(n+='<option value="'+d.fid+'">'+d.name+"</option>",d.sublist&&d.sublist.length>0))for(var s=0;s<d.sublist.length;++s){var l=d.sublist[s],c=o[l];c&&(n+='<option value="'+c.fid+'">&nbsp;&nbsp;&nbsp;&nbsp;'+c.name+"</option>")}}}}}function a(){d.loadcache("version=4&module=forumnav",function(e){if(r={},e.Variables.forums)for(var i=0;i<e.Variables.forums.length;++i){var t=e.Variables.forums[i];if(r[t.fid]=[],t.threadtypes&&t.threadtypes.types)for(var a in t.threadtypes.types){var o={tid:a,name:t.threadtypes.types[a]};r[t.fid].push(o)}}},!0)}var o,n,r,d=e("ajax"),s={};return s.getForumInfo=function(e){return o||i(),o[e]},s.getHotForums=function(){var e=[],i=[],t=bigstyle_conf.hotforums;if(0==t.source&&t.forums.length>0)i=t.forums;else{var a="version=4&module=hotforum";d.loadcache(a,function(e){if(e.Variables.data&&e.Variables.data.length)for(var t=0;t<e.Variables.data.length;++t){var a=e.Variables.data[t];i.push(a.fid)}},!0)}for(var n=0;n<i.length;++n){var r=i[n],l=s.getForumInfo(r);l&&l.icon&&e.push(l)}if(0==e.length)for(var r in o)if(e.push(o[r]),e.length>2)break;return e},s.getAllForumIds=function(){var e=[];o||i();for(var t in o)e.push(t);return e},s.getForumSelectOptions=function(){return n||i(),n},s.getForumThreadTypes=function(e){return r||a(),r[e]?r[e]:[]},s.getForumMap=function(){return o||i(),o},s}),define("data/thread",["require","data/forum","ajax"],function(e){var i=e("data/forum"),t=e("ajax"),a={};return a.getNewThreads=function(){var e=i.getForumMap(),t=0,o=0;for(var n in e){var r=e[n],d=parseInt(r.threads);d>o&&(t=n,o=d)}return a.getLastPostThreadsOfForum(t,1)},a.getHotThreads=function(){var e=i.getForumMap(),t=0,o=0;for(var n in e){var r=e[n],d=parseInt(r.threads);d>o&&(t=n,o=d)}return a.getHotThreadsOfForum(t,1)},a.getLastPostThreadsOfForum=function(e,i){var o=[],n="version=4&module=forumdisplay&fid="+e+"&page="+i+"&filter=lastpost&orderby=lastpost";return MWT.show_loading(),t.post(n,{},function(e){MWT.hide_loading(),o=a.getParseThreadRes(e)},!0),o},a.getHotThreadsOfForum=function(e,i){var o=[],n="version=4&module=forumdisplay&fid="+e+"&page="+i+"&filter=heat&orderby=heats";return MWT.show_loading(),t.post(n,{},function(e){MWT.hide_loading(),o=a.getParseThreadRes(e)},!0),o},a.getParseThreadRes=function(e){var i=[];if(!e.Variables.forum_threadlist.length)return i;for(var t=e.Variables.forum_threadlist.length,a=0;t>a;++a){var o=e.Variables.forum_threadlist[a];if(!(o.displayorder>0)){var n=dz_avatar(o.authorid),r='<div name="topthread" data-tid="'+o.tid+'" class="weui_cell" style="display:block;"><div style="font-size:12px;"><img src="'+n+'" style="border-radius:300px;width:30px;height:30px;vertical-align:top"><span style="margin:0 8px;display:inline-block;font-size:12px;color:#333;">'+o.author+'<br><span style="float:left;font-size:11px;color:#999;">'+o.lastpost+'</span></span></div><div class="weui_cell_bd weui_cell_primary">'+o.subject+'</div><div class="weui_cell_ft" style="font-size:13px;"><i class="icon icon-comment"></i> '+o.replies+'&nbsp;&nbsp;&nbsp;<i class="icon icon-preview"></i> '+o.views+"</div></div>";i.push(r)}}return i},a}),define("index/index_tab",["require","data/thread","common/location"],function(e){var i=e("data/thread"),t=function(t,a){function o(e){a&&a(n,e)}var n;this.init=function(){var e=new MWT.TabPanel({title:"最新帖子",body:'<div id="'+t+'-tabbody-1"></div>'});e.on("show",function(){n=1,o(1)});var i=new MWT.TabPanel({title:"热门帖子",body:'<div id="'+t+'-tabbody-2"></div>'});i.on("show",function(){n=2,o(1)});var a=new MWT.TabWidget({render:t,panels:[e,i],headerStyle:""});a.show().active(0)},this.show_list=function(a,o,r){var d=[],s=(dz.bodyWidth-80,0);a.Variables.data&&a.Variables.data.length&&(s=a.Variables.data.length);for(var l=0;s>l;++l){var c=a.Variables.data[l],u=dz_avatar(c.authorid),p='<div name="topthread" data-tid="'+c.tid+'" class="weui_cell" style="display:block;"><div style="font-size:12px;"><img src="'+u+'" style="border-radius:300px;width:30px;height:30px;vertical-align:top"><span style="margin:0 8px;display:inline-block;font-size:12px;color:#333;">'+c.author+'<br><span style="float:left;font-size:11px;color:#999;">'+c.dateline+'</span></span></div><div class="weui_cell_bd weui_cell_primary">'+c.subject+'</div><div class="weui_cell_ft" style="font-size:13px;"><i class="icon icon-comment"></i> '+c.replies+'&nbsp;&nbsp;&nbsp;<i class="icon icon-preview"></i> '+c.views+"</div></div>";d.push(p)}var f=t+"-tabbody-"+n,m=1==o?f:f+"-"+o;1==o&&0==d.length&&(d=1==n?i.getNewThreads():i.getHotThreads());var v='<div style="background:#fff;"><div class="weui_cells" style="margin:0;">'+d.join("")+"</div></div>";jQuery("#"+m).html(v),jQuery("[name=topthread]").unbind("click").click(function(){var i=jQuery(this).data("tid");e("common/location").viewthread(i)})}};return t}),define("common/copyright",["require"],function(e){var i={};return i.footer=function(){var e='<div style="text-align:center;font-size:13px;padding:15px 0;"><div style="display:inline-block;"><a href="'+dz.siteurl+'forum.php?mobile=1&amp;simpletype=no" style="color:#666;">标准版</a>&nbsp;&nbsp;|&nbsp;&nbsp;<a href="javascript:;" style="color:#bbb;">触屏版</a>&nbsp;&nbsp;|&nbsp;&nbsp;<a href="'+dz.siteurl+'forum.php?mobile=no" style="color:#666;">电脑版</a>&nbsp;&nbsp;|&nbsp;&nbsp;<a href="http://www.discuz.net/mobile.php?platform=ios" style="color:#666;">客户端</a></div><p style="color:#666;">&copy; '+bigstyle_conf.copyright+"</p></div>";return e},i}),define("member/login",["require","ajax"],function(e){var i=e("ajax"),t={};return t.login=function(){window.location=dz.loginurl},t.logout=function(){var e=i.getFormHash();e&&""!=e||i.post("version=4&module=profile",{},function(i){e=i.Variables.formhash},!0);var t="version=4&module=login&action=logout&formhash="+e;i.post(t,{},function(e){MWT.toast({msg:"您已退出登录"},function(){window.location="forum.php?uc=1"})})},t}),define("common/sidebar",["require","member/login"],function(e){function i(){a=new MWT.SideBar({render:"uc-sidebar",width:"200px;",bodyStyle:"background:rgba(0,0,0,0.9);padding:0 0 20px 0;z-index:1;",pagebody:'<div id="uc-sidebar-div"></div>'}),a.on("open",t)}function t(){var i=dz.avatar,t=dz.username;0==dz.uid&&(t="点击登录<br><span>登录后可使用更多功能哦~</span>");var a='<div id="uc-sidebar-btn" class="spacebg mwt-border-bottom" style="background:inherit;color:#fff;padding:20px 0;"><img src="'+i+'"><p>'+t+"</p></div>",o=bigstyle_conf.uclist;a+='<div class="weui_cells weui_cells_access noline" style="background:inherit;margin-top:0;">';for(var n=0;n<o.length;++n){var r=o[n];r.title&&(a+='<a class="weui_cell noline" href="'+r.href+'" style="background:inherit;padding:5px;"> <div class="weui_cell_hd"><i class="'+r.icon+'" style="color:'+r.iconcolor+';font-size:22px;padding:7px;display:block;margin-right:6px;"></i></div><div class="weui_cell_bd weui_cell_primary"><p style="font-family:\'microsoft yahei\';color:#d9d9d9;">'+r.title+"</p></div></a>")}a+="</div>",jQuery("#uc-sidebar-div").html(a),jQuery("#uc-sidebar-btn").click(function(){0==dz.uid&&e("member/login").login()})}var a,o={};return o.open=function(){a||i(),a.open()},o}),define("common/header",["require","common/sidebar"],function(e){var i={};return i.createHeader=function(i){i.position="top",i.cls="headbar",i.height||(i.height=40);for(var t=[],a=0;a<i.items.length;++a){var o=i.items[a];switch(o){case"back":t.push({type:"back",width:40,style:"font-size:20px;margin-top:5px;display:inline-block;"});break;case"home":t.push({icon:"icon icon-home",width:40,iconStyle:"font-size:18px;margin-top:5px;display:inline-block;",handler:function(){window.location="forum.php?mobile=2"}});break;case"search":t.push({icon:"icon icon-search",width:40,iconStyle:"font-size:18px;margin-top:5px;display:inline-block;",handler:function(){window.location="search.php?mod=forum&mobile=2"}});break;case"uc":t.push({icon:"icon icon-user",width:40,iconStyle:"font-size:18px;margin-top:5px;display:inline-block;",handler:function(){e("common/sidebar").open()}});break;default:t.push(o)}}return i.items=t,new MWT.H5Navbar(i)},i.getHeaderIconStyle=function(){return"font-size:20px;margin-top:5px;"},i}),define("ad/adengine",["require"],function(e){var i={};return i.adtag=function(){var e='<span class="adtag">广告</span>';return e},i.getad=function(e,i){var t=bigstyle_conf.adapi;if(t&&""!=t){var a={adtype:e,site:dz.siteurl,bbname:dz.bbname,sitename:dz.sitename};jQuery.ajax({url:t,type:"post",dataType:"json",data:a,success:function(e){if(e.data){var t=e.data;i&&i(t)}}})}},i.run=function(e){for(e();;)setTimeout(e,3e5)},i}),define("ad/global_full_ad",["require","ajax","./adengine"],function(e){function i(){a.getad(1,function(e){var i=dz.bodyHeight-135,a='<a href="'+e.adurl+'" class="ad"><img src="'+e.adimg+'" style="width:100%;height:'+i+'px;"></a>';jQuery("#global_full_ad_div").html(a),t.open()})}var t,a=(e("ajax"),e("./adengine")),o={};return o.init=function(){var e=dz.bodyHeight-140;t=new MWT.H5Dialog({render:"global_full_ad",top:50,animate:"addialog zoomIn",height:e,body:'<div id="global_full_ad_div"></div><div style="position:absolute;bottom:1px;right:1px;">'+a.adtag()+"</div>"}),t.create(),setTimeout(i,5e3)},o}),define("ad/horizontal_ad",["require","ajax","./adengine"],function(e){function i(){a.getad(2,function(e){var i='<div style="position:relative;line-height:0;height:60px;"><a href="'+e.adurl+'" class="ad"><img src="'+e.adimg+'" style="width:100%;height:60px;"></a><div style="position:absolute;bottom:12px;right:2px;">'+a.adtag()+"</div></div>";jQuery("#"+t).html(i)})}var t,a=(e("ajax"),e("./adengine")),o={};return o.init=function(e){t=e,i()},o}),define("index/page",["require","common/location","./index_tab","ajax","common/copyright","common/header","data/forum","ad/global_full_ad","ad/horizontal_ad","data/forum"],function(e){function i(){var i='<div style="margin:40px 0 45px;background-color:#f2f2f2;"><div id="indexbannerdiv" style="width:100%;height:160px;background:#eee;"></div><div id="indexhotdiv" style="background:#fff;"></div><div id="herad-div"></div><div id="indexbodydiv" style="margin-top:10px;"></div>'+e("common/copyright").footer()+'</div><div id="headdiv" style="position:fixed;top:0;left:0;right:0;"></div>';jQuery("body").append(i);var d=e("common/header").createHeader({render:"headdiv",items:["uc",{label:"<h1>"+dz.bbname+"</h1>"},"search"]});d.create(),t(),r=e("data/forum").getAllForumIds(),n=new s("indexbodydiv",o),n.init(),a(),e("ad/global_full_ad").init(),e("ad/horizontal_ad").init("herad-div")}function t(){for(var e=[],i=0;i<bigstyle_conf.banners.length;++i){var t=bigstyle_conf.banners[i];e.push({url:t.image,handler:function(e){window.location=bigstyle_conf.banners[e].href}})}var a=new MWT.Slide({render:"indexbannerdiv",autoplay:0,images:e});a.create()}function a(){var i=e("data/forum").getHotForums();if(0!=i.length){var t='<div class="weui_cells_title mwt-border-bottom" style="margin:0;">热门版块</div><div id="indexhotdiv-f"></div>';jQuery("#indexhotdiv").html(t);for(var a=i.length<4?i.length:4,o=[],n=0;a>n;++n){var r=i[n],t='<div name="ffsasdw" data-fid="'+r.fid+'"><img src="'+r.icon+'" style="width:30px;height:30px;"><br><span style="font-size:14px;">'+r.name+"</span></div>";o.push({html:t})}var s=new MWT.TabBox({render:"indexhotdiv-f",size:"1x"+a,border:!1,cellStyle:"text-align:center;padding:5px 0;line-height:20px;",items:o});s.on("show",function(){jQuery("[name=ffsasdw]").click(function(){var e=jQuery(this).data("fid");d.forumdisplay(e)})}),s.show()}}function o(e,i){var t="version=4",a=20;switch(e){case 1:var o=(i-1)*a;t+="&module=newthreads&fids="+r.join(",")+"&start="+o+"&limit="+a;break;case 2:t+="&module=hotthread";break;default:return}MWT.show_loading(),l.post(t,{},function(t){MWT.hide_loading();var o=1==e?a:parseInt(t.Variables.perpage);n.show_list(t,i,o)})}var n,r,d=e("common/location"),s=e("./index_tab"),l=e("ajax"),c={};return c.open=function(e){i()},c}),define("forum/forumlist",["require","ajax","common/copyright","common/header","ad/horizontal_ad"],function(e){function i(){var i='<div style="margin:40px 0 45px;"><div id="ad-div"></div><div id="forumlistdiv"></div>'+e("common/copyright").footer()+"</div>";jQuery("body").append(i).css("background","#f2f2f2");var a=e("common/header").createHeader({items:["uc",{label:"<h1>论坛</h1>"},"search"]});a.create(),t(),e("ad/horizontal_ad").init("ad-div")}function t(){o.post("version=4&module=forumindex",{},function(e){a(e.Variables.catlist,e.Variables.forumlist)})}function a(e,i){for(var t={},a=0;a<i.length;++a){var o=i[a];t[o.fid]=a}for(var n="",a=0;a<e.length;++a){var r=e[a].name,d=0==a?'style="margin:0;"':"";n+='<div style="background:#fff;"><div class="weui_cells_title mwt-border-bottom" '+d+">"+r+'</div><div class="weui_cells">';for(var s=0;s<e[a].forums.length;++s){var l=e[a].forums[s],c=t[l],u=i[c],p=u.icon?u.icon:bigstyle_conf.default_forum_icon;n+='<div name="fmdiv" data-fid="'+l+'" data-fname="'+u.name+'" class="weui_cell"><div class="weui_cell_hd"><img src="'+p+'" style="width:40px;height:40px;margin-right:10px;display:block"></div><div class="weui_cell_bd weui_cell_primary">'+u.name+'<br><span style="font-size:13px;">主题:'+u.threads+" | 帖子:"+u.posts+'</span></div><div class="weui_cell_ft"><span style="border-radius:300px;background:#666;color:#fff;font-size:12px;padding:5px 10px;">今日: '+u.todayposts+"</span></div></div>"}n+="</div></div>"}jQuery("#forumlistdiv").html(n),jQuery("[name=fmdiv]").click(function(){var e=jQuery(this).data("fid");window.location="forum.php?mod=forumdisplay&fid="+e})}var o=e("ajax"),n={};return n.open=function(e){i()},n}),define("forum/thread_tab",["require"],function(e){var i=function(e,i){function t(e){i&&i(a,e)}var a;this.init=function(){var i=new MWT.TabPanel({title:"全部",body:'<div id="'+e+'-tabbody-1"></div>'});i.on("show",function(){a=1,t(1)});var o=new MWT.TabPanel({title:"最新",body:'<div id="'+e+'-tabbody-2"></div>'});o.on("show",function(){a=2,t(1)});var n=new MWT.TabPanel({title:"精华",body:'<div id="'+e+'-tabbody-3"></div>'});n.on("show",function(){a=3,t(1)});var r=new MWT.TabPanel({title:"热门",body:'<div id="'+e+'-tabbody-4"></div>'});r.on("show",function(){a=4,t(1)});var d=new MWT.TabWidget({render:e,panels:[i,o,n,r],headerStyle:""});d.show().active(0)},this.show_list=function(i){for(var o=[],n=(dz.bodyWidth-80,i.Variables.forum_threadlist.length),r=0;n>r;++r){var d=i.Variables.forum_threadlist[r];if(!(d.displayorder>0)){var s=dz_avatar(d.authorid),l='<div name="topthread" data-tid="'+d.tid+'" class="weui_cell" style="display:block;"><div style="font-size:12px;"><img src="'+s+'" style="border-radius:300px;width:30px;height:30px;vertical-align:top"><span style="margin:0 8px;display:inline-block;font-size:12px;color:#333;">'+d.author+'<br><span style="float:left;font-size:11px;color:#999;">'+d.lastpost+'</span></span></div><div class="weui_cell_bd weui_cell_primary">'+d.subject+'</div><div class="weui_cell_ft" style="font-size:13px;"><i class="icon icon-comment"></i> '+d.replies+'&nbsp;&nbsp;&nbsp;<i class="icon icon-preview"></i> '+d.views+"</div></div>";o.push(l)}}var c=parseInt(i.Variables.page),u=e+"-tabbody-"+a,p=1==c?u:u+"-"+c,f='<div style="background:#fff;"><div class="weui_cells" style="margin:0;">'+o.join("")+"</div></div>";if(has_next_page(c,i.Variables.forum.threads,i.Variables.tpp,n)){var m=c+1;f+='<div id="'+u+"-"+m+'"><button id="'+u+'-nbtn" data-page="'+m+'" class="nextbtn">点击加载下一页</button></div>'}jQuery("#"+p).html(f),jQuery("#"+u+"-nbtn").unbind("click").click(function(){var e=jQuery(this).data("page");t(e)}),jQuery("[name=topthread]").unbind("click").click(function(){var e=jQuery(this).data("tid");window.location="forum.php?mod=viewthread&tid="+e})}};return i}),define("forum/forumdisplay",["require","common/header","ajax","./thread_tab","common/copyright","common/header","ad/horizontal_ad"],function(e){function i(){var i='<div style="margin:40px 0 45px;"><div id="ad-div"></div><div id="forumlist-topdiv-'+o+'"></div><div id="formtabdiv-'+o+'" style="margin-top:.77em;"></div>'+e("common/copyright").footer()+"</div>";jQuery("body").append(i).css("background","#f2f2f2");var a=e("common/header").createHeader({items:["back","home",{label:'<h1 id="forumpagetitle-'+o+'">论坛</h1>'},{width:40},{icon:"icon icon-ask",iconStyle:d,width:40,handler:function(){window.location="forum.php?mod=post&action=newthread&fid="+o}}]});a.create(),c=!0,n=new l("formtabdiv-"+o,t),n.init(),e("ad/horizontal_ad").init("ad-div")}function t(e,i){var t="version=4&module=forumdisplay&fid="+o+"&page="+i;switch(e){case 2:t+="&filter=lastpost&orderby=lastpost";break;case 3:t+="&filter=digest&digest=1";break;case 4:t+="&filter=heat&orderby=heats"}MWT.show_loading(),s.post(t,{},function(e){MWT.hide_loading(),c&&(c=!1,a(e)),n.show_list(e)})}function a(e){var i=e.Variables.forum;jQuery("#forumpagetitle-"+o).html(i.name);var t=i.icon?i.icon:bigstyle_conf.default_forum_icon,a='<div name="fmdiv" data-fname="'+i.name+'" class="weui_cell"><div class="weui_cell_hd"><img src="'+t+'" style="width:40px;height:40px;margin-right:10px;display:block"></div><div class="weui_cell_bd weui_cell_primary">'+i.name+'<br><span style="font-size:13px;">主题:'+i.threads+" | 帖子:"+i.posts+'</span></div><div class="weui_cell_ft"><span name="fav-forum-btn" data-fid="'+o+'" style="border-radius:300px;background:#f1f1f1;color:#DA5D0C;font-size:12px;padding:5px 10px;"><i class="icon icon-favor"></i> 收藏</span></div></div>';if(e.Variables.sublist.length>0){for(var n=[],r=dz.bodyWidth-120,d=0;d<e.Variables.sublist.length;++d){var l=e.Variables.sublist[d],c='<div name="subforum" data-fid="'+l.fid+'" class="weui_cell"><div class="weui_cell_bd weui_cell_primary"><span class="text-block-nowrap" style="width:'+r+'px">'+l.name+'</span></div><div class="weui_cell_ft" style="font-size:13px;"><span style="font-size:12px;">今日: '+l.todayposts+"</span></div></div>";n.push(c)}a+='<div style="background:#fff;"><div class="weui_cells_title mwt-border-bottom">子版块</div><div class="weui_cells">'+n.join("")+"</div></div>"}if(e.Variables.forum_threadlist.length>0){for(var u=[],r=dz.bodyWidth-80,d=0;d<e.Variables.forum_threadlist.length;++d){var l=e.Variables.forum_threadlist[d];if(0!=l.displayorder){var c='<div name="topthread" data-tid="'+l.tid+'" class="weui_cell"><div class="weui_cell_bd weui_cell_primary"><span class="text-block-nowrap" style="width:'+r+'px">'+l.subject+'</span></div><div class="weui_cell_ft" style="font-size:13px;"><i class="icon icon-preview"></i> '+l.views+"</div></div>";u.push(c)}}u.length>0&&(a+='<div style="background:#fff;"><div class="weui_cells_title mwt-border-bottom">置顶</div><div class="weui_cells">'+u.join("")+"</div></div></div>")}jQuery("#forumlist-topdiv-"+o).html(a),e.Variables.sublist.length>0&&jQuery("[name=subforum]").click(function(){var e=jQuery(this).data("fid");window.location="forum.php?mod=forumdisplay&fid="+e}),jQuery("[name=fav-forum-btn]").click(function(){var e=jQuery(this).data("fid"),i="version=4&module=favforum&id="+e+"&formhash="+s.getFormHash();s.post(i,{},function(e){e.Message&&"favorite_do_success"==e.Message.messageval?MWT.toast({msg:"已收藏"}):"favorite_repeat"==e.Message.messageval?MWT.toast({msg:"已收藏"}):MWT.alert({msg:e.Message.messagestr})})})}var o,n,r=e("common/header"),d=r.getHeaderIconStyle(),s=e("ajax"),l=e("./thread_tab"),c=!0,u={};return u.open=function(e,t){o=t,i()},u}),define("common/seccode",["require"],function(e){var i={};return i.create=function(e,i){var t=i?i:"",a=dz.securl+"&update="+time(),o='<img id="sec-'+e+'" src="'+a+'" style="cursor:pointer;'+t+'">';jQuery("#"+e).html(o),jQuery("#sec-"+e).click(function(){var e=dz.securl+"&update="+time();jQuery(this).attr("src",e)})},i}),define("forum/newthread",["require","common/header","ajax","data/forum","common/location","common/copyright","common/seccode","member/login","common/location"],function(e){function i(){d=new MWT.Form,d.addField("subject",new MWT.TextField({render:"titlediv",value:"",placeholder:"标题",errmsg:"标题不能超过35个字符",style:"width:"+(dz.bodyWidth-50)+"px",checkfun:function(e){return e.length<=35}})),d.addField("message",new MWT.TextField({type:"textarea",render:"contentdiv",style:"width:100%;height:170px;",value:"",placeholder:"说点什么吧~",errmsg:"内容不能超过1000个字符",checkfun:function(e){return e.length<=1024}}));var i="none";"0"!=dz.postseccheck&&(i="flex",d.addField("seccodeverify",new MWT.TextField({render:"secdiv",value:"",placeholder:"验证码",style:"width:120px;",errmsg:"内容不能超过1000个字符",checkfun:function(e){return e.length<=1024}}))),n=new MWT.H5Page({render:"page-forum-"+r,header:l.createHeader({items:[{icon:"icon icon-left",iconStyle:"font-size:20px;margin-top:5px;",width:40,handler:function(){e("common/location").back("forum.php?forumlist=1")}},{label:"<h1>发新帖</h1>"},{label:"发帖",width:40,handler:f.submit}]}),bodyStyle:"background-color:#f2f2f2;padding:0;",pagebody:'<div class="weui_cells weui_cells_form" style="margin-top:0;"><div class="weui_cell weui_cell_select"><div class="weui_cell_bd weui_cell_primary"><select class="weui_select" id="forumsel"></select></div></div><div class="weui_cell weui_cell_select" id="typeseldiv" style="display:none;"><div class="weui_cell_bd weui_cell_primary"><select class="weui_select" id="typesel"></select></div></div><div class="weui_cell"><div class="weui_cell_bd weui_cell_primary" id="titlediv"></div></div><div class="weui_cell"><div class="weui_cell_bd weui_cell_primary" id="contentdiv"></div></div><div class="weui_cell"><div class="weui_cell_bd weui_cell_primary"><div class="weui_uploader"><div class="weui_uploader_bd"><ul id="attaul" class="weui_uploader_files mwt-imgup-ul" style="display:block;"></ul><div class="weui_uploader_input_wrp"><form method="POST" enctype="multipart/form-data"></form><input id="picup-newth" name="Filedata" class="weui_uploader_input" type="file" accept="image/jpg,image/jpeg,image/png,image/gif"></form></div></div></div></div></div><div class="weui_cell weui_vcode" style="display:'+i+'"><div class="weui_cell_bd weui_cell_primary" id="secdiv"></div><div class="weui_cell_ft" id="secimg"></div></div></div>'+e("common/copyright").footer()}),n.on("open",function(){d.create(),e("common/seccode").create("secimg","width:150px;"),d.reset(),a(),jQuery("#attaul").html(),jQuery("#picup-newth").change(t)})}function t(){jQuery.ajaxFileUpload({url:c.getAjaxUrl("version=4&module=forumupload&type=image&inajax=yes&infloat=yes&simple=2"),secureuri:!1,fileElementId:"picup-newth",data:{uid:dz.uid,hash:dz.hash},timeout:3e4,complete:function(e){jQuery("#picup-newth").change(t)},success:function(e,i){var t=e.body.innerHTML,a=t.split("|"),o=a[3];p[o]={description:""};var n="data/attachment/forum/"+a[5],r='<li id="upimg-'+o+'"><img src="'+n+'" style="max-width:90px;max-height:90px;"><i name="upimg-del" data-idx="'+a[3]+'" class="fa fa-minus-circle"></i></li>';jQuery("#attaul").append(r),jQuery('[name="upimg-del"]').unbind("click").click(function(){var e=jQuery(this).data("idx");jQuery("#upimg-"+e).html(""),delete p[e]})},error:function(e,i,t){}})}function a(){var e=u.getForumSelectOptions();jQuery("#forumsel").html(e),0!=r&&set_select_value("forumsel",r),o(),jQuery("#forumsel").unbind("change").change(o)}function o(){jQuery("#typesel").html('<option value="0">请选择主题分类</option>');var e=get_select_value("forumsel"),i=u.getForumThreadTypes(e);if(i&&i.length){for(var t='<option value="0">请选择主题分类</option>',a=0;a<i.length;++a){var o=i[a];t+='<option value="'+o.tid+'">'+o.name+"</option>"}jQuery("#typesel").html(t),jQuery("#typeseldiv").show()}else jQuery("#typesel").html('<option value="0">请选择主题分类</option>'),jQuery("#typeseldiv").hide()}var n,r,d,s,l=e("common/header"),c=e("ajax"),u=e("data/forum"),p={},f={};return f.open=function(t,a,o){return 0==dz.uid?void e("member/login").login():(n||i(),r=a?a:0,s=o?o:null,void n.setAnimate(t).open())},f.submit=function(){var i=d.getData();if(i.fid=get_select_value("forumsel"),i.typeid=get_select_value("typesel"),i.attachnew=p,0==i.fid)return void MWT.alert("请选择版块");i.formhash=c.getFormHash(),i.posttime=time(),i.topicsubmit="yes";var t="version=4&module=newthread&extra=&inajax=1";c.post(t,i,function(t){return t.Message&&t.Message.messagestr?"post_newthread_succeed"==t.Message.messageval?void MWT.toast({msg:"发帖成功"},function(){e("common/location").forumdisplay(i.fid)}):void MWT.alert({msg:t.Message.messagestr}):(MWT.alert("服务端异常,请刷新页面重试"),void console.log(t))})},f}),define("forum/sendreply",["require","common/header","ajax","common/seccode"],function(e){function i(){o=new MWT.Form,o.addField("message",new MWT.TextField({type:"textarea",render:"contentdiv",style:"width:100%;height:200px;",value:"",placeholder:"说点什么吧~",errmsg:"内容不能超过1000个字符",checkfun:function(e){return e.length<=1024}}));var i="none";"0"!=dz.postseccheck&&(i="flex",o.addField("seccodeverify",new MWT.TextField({render:"secdiv",value:"",placeholder:"验证码",style:"width:120px;",errmsg:"内容不能超过1000个字符",checkfun:function(e){return e.length<=1024}}))),t=new MWT.H5Page({render:"page-reply-"+a,header:d.createHeader({items:[{icon:"icon icon-left",iconStyle:"font-size:20px;margin-top:5px;",width:40,handler:function(){t.close()}},{label:"<h1>发表回复</h1>"},{label:"回复",width:40,handler:l.submit}]}),bodyStyle:"background-color:#f2f2f2;padding:0;",pagebody:'<div class="weui_cells weui_cells_form"><div class="weui_cell"><div class="weui_cell_bd weui_cell_primary" id="contentdiv"></div></div><div class="weui_cell weui_vcode" style="display:'+i+'"><div class="weui_cell_bd weui_cell_primary" id="secdiv"></div><div class="weui_cell_ft" id="secimg"></div></div></div>'}),t.on("open",function(){o.create(),e("common/seccode").create("secimg","width:150px;"),o.reset()})}var t,a,o,n,r,d=e("common/header"),s=e("ajax"),l={};return l.open=function(e,o,d,s){a=o?o:0,n=d,0!=a&&(t||i(),r=s?s:null,t.setAnimate(e).open())},l.submit=function(){var e=o.getData();e.formhash=n;var i="version=4&module=sendreply&replysubmit=yes&extra=&inajax=1&tid="+a;s.post(i,e,function(e){return e.Message&&e.Message.messagestr?"post_reply_succeed"==e.Message.messageval?void MWT.toast({msg:"回复成功"},function(){t.close(),r&&r()}):void MWT.alert({msg:e.Message.messagestr}):(MWT.alert("服务端异常,请刷新页面重试"),void console.log(e))})},l}),define("forum/viewthread",["require","common/header","ajax","common/copyright","./sendreply","ad/horizontal_ad"],function(e){function i(e){var i=dz.siteurl+"/forum.php?mod=topicadmin&action=moderate&optgroup=3&modsubmit=yes&mobile=2&handlekey=moderateform&inajax=1",t={frommodcp:"",formhash:c.getFormHash(),fid:e,reason:"手机版主题操作","moderate[]":d,"operations[]":"delete"};c.post3(i,t,function(i){var t=jQuery("root",i).text();MWT.alert(t,function(){window.location="forum.php?mod=forumdisplay&fid="+e+"&mobile=2"})})}function t(){var i='<div style="line-height:40px;">&nbsp;</div><div id="ad-div"></div><div id="vth-topdiv-'+d+'" style="background:#fff;"></div><div style="background:#fff;margin-bottom:5px;"><div class="weui_cells_title mwt-border-bottom">相关回复</div><div id="vthdiv-'+d+'" style="min-height:50px;"></div></div>'+e("common/copyright").footer()+'<div style="line-height:45px;">&nbsp;</div><div id="headdiv" style="position:fixed;top:0;left:0;right:0;"></div><div id="footdiv" style="position:fixed;bottom:0;left:0;right:0;">';jQuery("body").append(i).css("background","#f2f2f2");var t=l.createHeader({render:"headdiv",items:["back","home",{label:'<h1 id="threadtitle'+d+'">查看帖子</h1>'},{label:"",width:40},{label:"",width:40}]});t.create();var o=new MWT.H5Navbar({render:"footdiv",position:"bottom",cls:"footbar mwt-border-top",height:45,items:[{icon:"icon icon-comment",label:"回复",handler:function(){e("./sendreply").open("slideRight",d,s,function(){a(1)})}},{icon:"icon icon-favor",label:"收藏",handler:function(){var e="version=4&module=favthread&id="+d+"&formhash="+c.getFormHash();c.post(e,{},function(e){!e.Message||"favorite_do_success"!=e.Message.messageval&&"favorite_repeat"!=e.Message.messageval?MWT.alert({msg:e.Message.messagestr}):MWT.toast({msg:"已收藏"})})}}]});o.create(),u=!0,a(1),e("ad/horizontal_ad").init("ad-div")}function a(e){var i="version=4&module=viewthread&tid="+d+"&page="+e;MWT.show_loading(),c.post(i,{},function(i){s=i.Variables.formhash,MWT.hide_loading(),u&&(u=!1,o(i)),r(i,e)})}function o(e){var t=e.Variables.thread,a='<div class="mwt-border-bottom"><table class="tablay"><tr><td style="padding:2px 5px;"><span style="font-size:18px;color:#333;">'+t.subject+'</span><br><span style="float:right;display:block;color:#aaa;font-size:12px;padding-right:5px;"><i class="icon icon-preview"></i> '+t.views+'&nbsp;&nbsp;&nbsp;<i class="icon icon-comment"></i> '+t.replies+"</span></tr></table></div>",o=e.Variables.postlist[0],n=dz_avatar(o.authorid),r=[],s=[];
if(o.attachments)for(var l in o.attachments){var c=o.attachments[l];if(c.url)if("1"==c.isimage){var u='<img src="'+c.url+c.attachment+'">';r.push(u)}else{var p=c.filename;"Untitled"==p&&(p="点击下载附件");var f='<a href="'+c.url+c.attachment+'" style="color:#2366A8;text-decoration:underline;font-size:13px;">'+p+" ("+c.attachsize+", 下载: "+c.downloads+")</a>";s.push(f)}}var m="";1==dz.groupid&&(m='<br><a href="javascript:;" name="threaddel" data-fid="'+e.Variables.fid+'">删除</a>'),a+='<div><div class="weui_cell" style="padding:5px;"><div class="weui_cell_hd"><img src="'+n+'" style="border-radius:300px;width:30px;height:30px;vertical-align:top;"></div><div class="weui_cell_bd weui_cell_primary"><span style="margin:0 8px;display:inline-block;font-size:12px;color:#333;">'+o.author+'<br><span style="float:left;font-size:11px;color:#999;">'+o.dateline+'</span></span></div><div class="weui_cell_ft" style="font-size:11px;color:#aaa">1楼'+m+'</div></div><div style="padding:5px;word-break:break-all;" class="content-div">'+o.message+"<br>"+r.join("")+s.join("<br>")+"</div></div>",jQuery("#vth-topdiv-"+d).html(a),jQuery("[name=threaddel]").click(function(){var e=jQuery(this).data("fid");MWT.confirm({msg:"确定删除该主题吗？"},function(){i(e)})})}function n(e){var i=dz_avatar(e.authorid),t='<div class="mwt-border-bottom"><div class="weui_cell" style="padding:5px;"><div class="weui_cell_hd"><img src="'+i+'" style="border-radius:300px;width:30px;height:30px;vertical-align:top;"></div><div class="weui_cell_bd weui_cell_primary"><span style="margin:0 8px;display:inline-block;font-size:12px;color:#333;">'+e.author+'<br><span style="float:left;font-size:11px;color:#999;">'+e.dateline+'</span></span></div><div class="weui_cell_ft" style="font-size:11px;color:#aaa">'+e.number+'楼</div></div><div style="padding:5px;" class="content-div">'+e.message+"</div></div>";return t}function r(e,i){for(var t=[],o=e.Variables.postlist.length,r=0;o>r;++r){var s=e.Variables.postlist[r];1!=s.number&&t.push(n(s))}var l="vthdiv-"+d,c=1==i?l:l+"-"+i,u=t.join("");if(has_next_page(i,e.Variables.thread.replies,e.Variables.ppp,o)){var p=i+1;u+='<div id="'+l+"-"+p+'"><button id="'+l+'-nbtn" data-page="'+p+'" class="nextbtn">点击加载下一页</button></div>'}1==i&&""==u&&(u='<p align="center" style="color:#aaa;font-size:13px;margin-top:5px;">暂无回复</p>'),jQuery("#"+c).html(u),jQuery("#"+l+"-nbtn").unbind("click").click(function(){var e=jQuery(this).data("page");a(e)})}var d,s,l=e("common/header"),c=(l.getHeaderIconStyle(),e("ajax")),u=!0,p={};return p.open=function(e,i){d=i,t()},p}),define("data/notice",["ajax"],function(){function e(){var e="version=4&module=mynotelist";i.post(e,{},function(e){a=e.Variables.list},!0)}var i=require("ajax"),t={},a=[];return t.getlist=function(){return 0==a.length&&e(),a},t}),define("home/space_pm",["require","ajax","common/header","common/copyright","data/notice"],function(e){function i(){a=new MWT.H5Page({header:e("common/header").createHeader({items:[{label:"<h1>消息</h1>"}]}),bodyStyle:"background-color:#f2f2f2;padding:0;",pagebody:'<div id="mynotelistdiv"></div>'+e("common/copyright").footer()}),a.on("open",t)}function t(){var i=e("data/notice").getlist();if(0==i)return void jQuery("#mynotelistdiv").html("暂无消息");for(var t='<div class="weui_cells" style="margin-top:0;">',a=0;a<i.length;++a){var o=i[a];if(o.notevar&&o.notevar.tid){var n="<b>"+o.notevar.actorusername+"</b> 回复了您的帖子 "+o.notevar.subject;t+='<div name="topthread" data-tid="'+o.notevar.tid+'" class="weui_cell"><div class="weui_cell_bd weui_cell_primary"><p><i class="fa fa-circle" style="font-size:11px;color:#666;width:18px;"></i>'+n+"</p></div></div>"}}t+="</div>",jQuery("#mynotelistdiv").html(t),jQuery("[name=topthread]").unbind("click").click(function(){var e=jQuery(this).data("tid");window.location="forum.php?mod=viewthread&tid="+e})}var a,o=(e("ajax"),{});return o.open=function(e){a||i(),a.setAnimate(e).open()},o}),define("home/uc",["require","ajax","common/copyright","member/login"],function(e){function i(){a=new MWT.H5Page({bodyStyle:"background-color:#f2f2f2;padding:0 0 45px;",pagebody:'<div id="ucdiv"></div>'+e("common/copyright").footer()}),a.on("open",t)}function t(){var i=dz.avatar,t=dz.username;0==dz.uid&&(t="点击登录<br><span>登录后可使用更多功能哦~</span>");var a='<div id="ucbtn" class="spacebg"><img src="'+i+'"><p>'+t+"</p></div>",o=bigstyle_conf.uclist;a+='<div class="weui_cells weui_cells_access">';for(var n=0;n<o.length;++n){var r=o[n];a+=r.title?'<a class="weui_cell" href="'+r.href+'"> <div class="weui_cell_hd"><i class="'+r.icon+'" style="background:'+r.iconcolor+';color:#fff;font-size:16px;padding:7px;border-radius:300px;display:block;margin-right:10px;"></i></div><div class="weui_cell_bd weui_cell_primary"><p style="font-family:\'microsoft yahei\';">'+r.title+'</p></div><div class="weui_cell_ft"></div></a>':'</div><div class="weui_cells weui_cells_access">'}a+="</div>",jQuery("#ucdiv").html(a),jQuery("#ucbtn").click(function(){0==dz.uid&&e("member/login").login()})}var a,o=(e("ajax"),{});return o.open=function(e){a||i(),a.setAnimate(e).open()},o}),define("home/space_profile",["require","common/header","ajax","common/header"],function(e){function i(){var i='<div id="uc-profile-body" style="padding-top:20px;"></div><div id="headdiv" style="position:fixed;top:0;left:0;right:0;"></div>';jQuery("body").append(i).css("background","#f2f2f2");var a=e("common/header").createHeader({render:"headdiv",items:["back",{label:"<h1>我的资料</h1>"},"home"]});a.create(),t()}function t(){var e="version=4&module=profile";n.post(e,{},function(e){var i=e.Variables.space,t="",o=[["用户名",i.username],["用户组",i.group.grouptitle],["管理组",i.admingroup.grouptitle],["注册时间",i.regdate]];t+=a(o),o=[["主题数",i.threads],["回帖数",i.posts],["积分",i.credits]];for(var n in e.Variables.extcredits){var r=e.Variables.extcredits[n],d=e.Variables.space["extcredits"+n];o.push([r.title,d])}t+=a(o),jQuery("#uc-profile-body").html(t)})}function a(e){for(var i="<div class='weui_cells'>",t=0;t<e.length;++t){var a=e[t];i+='<div class="weui_cell"><div class="weui_cell_bd weui_cell_primary"><p>'+a[0]+'</p></div><div class="weui_cell_ft">'+a[1]+"</div></div>"}return i+="</div>"}var o=e("common/header"),n=(o.getHeaderIconStyle(),e("ajax")),r={};return r.open=function(e){i()},r}),define("home/space_thread",["require","common/location","common/header","ajax"],function(e){function i(){n=new MWT.H5Page({render:"uc-mythread",header:d.createHeader({items:[{icon:"icon icon-left",iconStyle:"font-size:20px;margin-top:5px;",width:40,handler:function(){r.back("forum.php?forumlist=1")}},{label:'<h1 id="mythreadtitle">我的帖子</h1>'},{label:"",width:40}]}),bodyStyle:"background-color:#f2f2f2;padding:0;",pagebody:'<div class="weui_cells" id="uc-mythreads-div" style="margin-top:0;"></div>'}),n.on("open",function(){var e="version=4&module=profile";s.post(e,{},function(e){l=e.Variables.space.threads,jQuery("#mythreadtitle").html("我的帖子("+l+")"),t(1)})})}function t(e){var i="version=4&module=mythread&page="+e;s.post(i,{},function(i){o(i,e)})}function a(e){var i=dz_avatar(e.authorid),t='<div name="topthread" data-tid="'+e.tid+'" class="weui_cell" style="display:block;"><div style="font-size:12px;"><img src="'+i+'" style="border-radius:300px;width:30px;height:30px;vertical-align:top"><span style="margin:0 8px;display:inline-block;font-size:12px;color:#333;">'+e.author+'<br><span style="float:left;font-size:11px;color:#999;">'+e.dateline+'</span></span></div><div class="weui_cell_bd weui_cell_primary">'+e.subject+'</div><div class="weui_cell_ft" style="font-size:13px;"><i class="icon icon-comment"></i> '+e.replies+'&nbsp;&nbsp;&nbsp;<i class="icon icon-preview"></i> '+e.views+"</div></div>";return t}function o(e,i){for(var o=[],n=e.Variables.data.length,d=0;n>d;++d)o.push(a(e.Variables.data[d]));var s="uc-mythreads-div",c=1==i?s:s+"-"+i,u=o.join("");if(has_next_page(i,l,e.Variables.perpage,n)){var p=i+1;u+='<div id="'+s+"-"+p+'"><button id="'+s+'-nbtn" data-page="'+p+'" class="nextbtn">点击加载下一页</button></div>'}jQuery("#"+c).html(u),jQuery("#"+s+"-nbtn").unbind("click").click(function(){var e=jQuery(this).data("page");t(e)}),jQuery("[name=topthread]").unbind("click").click(function(){var e=jQuery(this).data("tid");r.viewthread(e)})}var n,r=e("common/location"),d=e("common/header"),s=e("ajax"),l=0,c={};return c.open=function(e){n||i(),n.setAnimate(e).open()},c}),define("home/space_favorite",["require","common/location","common/header","ajax"],function(e){function i(){var e="uc-mythreads-div",i=new MWT.TabPanel({title:"帖子收藏",body:'<div id="myfav-tab-1"></div>'});i.on("show",function(){s=1,a(1)});var t=new MWT.TabPanel({title:"版块收藏",body:'<div id="myfav-tab-2"></div>'});t.on("show",function(){s=2,a(1)});var o=new MWT.TabWidget({render:e,panels:[i,t],headerStyle:""});o.show().active(0)}function t(){d=new MWT.H5Page({render:"uc-myfavor",header:c.createHeader({items:[{icon:"icon icon-left",iconStyle:"font-size:20px;margin-top:5px;",width:40,handler:function(){l.back("forum.php?forumlist=1")}},{label:'<h1 id="myfavtitle">我的收藏</h1>'},{label:"",width:40}]}),bodyStyle:"background-color:#f2f2f2;padding:0;",pagebody:'<div class="weui_cells" id="uc-mythreads-div" style="margin-top:0;"></div>'}),d.on("open",function(){i()})}function a(e){var i="";switch(s){case 1:i="version=4&module=myfavthread&page="+e;break;case 2:i="version=4&module=myfavforum&page="+e}u.post(i,{},function(i){r(i,e)})}function o(e){var i=dz_avatar(e.authorid),t=date("Y-m-d H:i",e.dateline),a='<div name="topthread" data-tid="'+e.id+'" class="weui_cell" style="display:block;"><div style="font-size:12px;"><img src="'+i+'" style="border-radius:300px;width:30px;height:30px;vertical-align:top"><span style="margin:0 8px;display:inline-block;font-size:12px;color:#333;">'+e.author+'<br><span style="float:left;font-size:11px;color:#999;">'+t+'</span></span></div><div class="weui_cell_bd weui_cell_primary">'+e.title+'</div><div class="weui_cell_ft" style="font-size:13px;"><i class="icon icon-comment"></i> '+e.replies+"</div></div>";return a}function n(e){var i='<div name="fmdiv" data-fid="'+e.id+'" class="weui_cell"><div class="weui_cell_bd weui_cell_primary">'+e.title+'<br><span style="font-size:13px;">主题:'+e.threads+" | 帖子:"+e.posts+'</span></div><div class="weui_cell_ft"><span style="border-radius:300px;background:#666;color:#fff;font-size:12px;padding:5px 10px;">今日: '+e.todayposts+"</span></div></div>";return i}function r(e,i){var t=[],r=e.Variables.list.length;switch(s){case 1:for(var d=0;r>d;++d)t.push(o(e.Variables.list[d]));break;case 2:for(var d=0;r>d;++d)t.push(n(e.Variables.list[d]))}var c="myfav-tab-"+s,u=1==i?c:c+"-"+i,p=t.join("");if(has_next_page(i,e.Variables.count,e.Variables.perpage,r)){var f=i+1;p+='<div id="'+c+"-"+f+'"><button id="'+c+'-nbtn" data-page="'+f+'" class="nextbtn">点击加载下一页</button></div>'}jQuery("#"+u).html(p),jQuery("#"+c+"-nbtn").unbind("click").click(function(){var e=jQuery(this).data("page");a(e)}),jQuery("[name=topthread]").unbind("click").click(function(){var e=jQuery(this).data("tid");l.viewthread(e)}),jQuery("[name=fmdiv]").unbind("click").click(function(){var e=jQuery(this).data("fid");l.forumdisplay(e)})}var d,s,l=e("common/location"),c=e("common/header"),u=e("ajax"),p={};return p.open=function(e){d||t(),d.setAnimate(e).open()},p}),define("setting/index",["require","member/login","common/location","common/header","ajax","common/copyright"],function(e){function i(){t=new MWT.H5Page({render:"uc-setting",header:o.createHeader({items:[{icon:"icon icon-left",iconStyle:"font-size:20px;margin-top:5px;",width:40,handler:function(){a.back("forum.php?forumlist=1")}},{label:'<h1 id="mythreadtitle">设置</h1>'},{label:"",width:40}]}),bodyStyle:"background-color:#f2f2f2;padding:0;",pagebody:'<div id="uc-setting-div"></div>'+e("common/copyright").footer()}),t.on("open",function(){var e=[[{title:"关于",href:"forum.php?about=1"}]];0!=dz.uid&&e.push([{title:"退出登录",href:"javascript:require('member/login').logout();"}]);for(var i="",t=0;t<e.length;++t){var a=e[t];i+='<div class="weui_cells weui_cells_access">';for(var o=0;o<a.length;++o){var n=a[o];i+='<a class="weui_cell" href="'+n.href+'"> <div class="weui_cell_bd weui_cell_primary"><p style="font-family:\'microsoft yahei\';">'+n.title+'</p></div><div class="weui_cell_ft"></div></a>'}i+="</div>"}jQuery("#uc-setting-div").html(i)})}e("member/login");var t,a=e("common/location"),o=e("common/header"),n=(e("ajax"),{});return n.open=function(e){t||i(),t.setAnimate(e).open()},n}),define("setting/about",["require","common/location","common/header","ajax"],function(e){function i(){a=new MWT.H5Page({render:"uc-setting-about",header:n.createHeader({items:[{icon:"icon icon-left",iconStyle:"font-size:20px;margin-top:5px;",width:40,handler:function(){o.back("forum.php?forumlist=1")}},{label:"<h1>关于</h1>"},{label:"",width:40}]}),bodyStyle:"background-color:#f2f2f2;padding:0;",pagebody:'<center><br><img src="'+dz.sitelogo+'" style="max-width:80px;max-height:80px;margin-bottom:10px;"><br><span>版本: '+bigstyle_conf.version+'</span></center><div style="position:absolute;bottom:10px;text-align:center;width:100%;font-size:13px;color:#666;">&copy; '+bigstyle_conf.copyright+'<p style="margin-top:4px;font-size:13px;color:#666;">theme by: <a href="http://addon.discuz.com/?@bigstyle.template" target="_blank"  style="text-decoration:underline;color:#666;">bigstyle</a></p></div>'}),a.on("open",function(){t()})}function t(){}var a,o=e("common/location"),n=e("common/header"),r=(n.getHeaderIconStyle(),e("ajax"),{});return r.open=function(e){a||i(),a.setAnimate(e).open()},r}),define("log",["require","conf"],function(e){function i(e,i){var t="["+e+"] "+i;console.log(t)}var t=e("conf").get(),a={};return a.debug=function(e){t.loglevel>=3&&i("DEBUG",e)},a.info=function(e){t.loglevel>=2&&i("INFO",e)},a.warn=function(e){t.loglevel>=1&&i("WARN",e)},a.uplog=function(e){var i="http://139.196.29.35:8888/api/bigstyle/pv";jQuery.ajax({url:i,type:"post",dataType:"json",data:{logstr:e},async:!0})},a});var bigstyle_conf,log;define("jsapp",["require","conf","index/page","forum/forumlist","forum/forumdisplay","forum/newthread","forum/viewthread","home/space_pm","home/uc","home/space_profile","home/space_thread","home/space_favorite","setting/index","setting/about","log"],function(e){bigstyle_conf=e("conf").get();var i={"index/page":e("index/page"),"forum/forumlist":e("forum/forumlist"),"forum/forumdisplay":e("forum/forumdisplay"),"forum/newthread":e("forum/newthread"),"forum/viewthread":e("forum/viewthread"),"home/space_pm":e("home/space_pm"),"home/uc":e("home/uc"),"home/space_profile":e("home/space_profile"),"home/space_thread":e("home/space_thread"),"home/space_favorite":e("home/space_favorite"),"setting/index":e("setting/index"),"setting/about":e("setting/about")},t={};return t.run=function(t,a){var o=isset(i[t])?t:"index/page";if(!in_array("mobile",dz.mobile_plugins)){var n="请安装并启用 <b style='color:red;'>掌上论坛</b> 插件(1.4.7版本及以上)";throw jQuery("body").html(n),new Error("请安装并启用掌上论坛插件(1.4.7版本及以上)")}log=e("log"),log.debug("dz: "+JSON.stringify(dz)),log.debug("bigstyle_conf: "+JSON.stringify(bigstyle_conf));var r=[dz.siteurl,"Discuz_"+dz.version+"_"+dz.charset,dz.bbname,dz.username+"(#"+dz.uid+")",bigstyle_conf.version,o,window.location.href];log.uplog(r.join("||")),i[o].open(pageOpenAnimate,a)},t});